---
const { timestamp, permalink, media, caption, type, id, title } = Astro.props;
import type { ChildrenData } from 'src/types/posts';
let carousel: ChildrenData[] = [],
  video,
  image;
if (type === 'CAROUSEL_ALBUM') {
  carousel = media as ChildrenData[];
} else if (type === 'VIDEO') {
  video = media;
} else {
  // let imagePath = 'assets/images/placeholder.webp';
  // image = imagePath;
  image = media;
}
---

{
  permalink && (
    <span
      class="igPost"
      onclick="window.open(this.attributes['data-href'].value)"
      data-href={permalink}
    >
      {timestamp} IG POST
    </span>
  )
}
{title && <span class="igPost">{`${timestamp} - ${title}`}</span>}
{!permalink && !title && <span class="igPost">{timestamp}</span>}
<p>{caption}</p>
{image && <img loading="lazy" src={image} alt={title ? title : id ? id : 'alt'} />}
{video && <video src={video} controls />}
{
  carousel &&
    carousel.map((carouselItem: ChildrenData) => {
      if (carouselItem.media_type === 'VIDEO') {
        return <video src={carouselItem.media_url} controls />;
      } else if (carouselItem.media_type === 'IMAGE') {
        // let imagePath = 'assets/images/placeholder.webp';
        // return (
        //   <img loading="lazy" src={imagePath} alt={carouselItem.id ? carouselItem.id : 'alt'} />
        // );
        return (
          <img
            loading="lazy"
            src={carouselItem.media_url}
            alt={carouselItem.id ? carouselItem.id : 'alt'}
          />
        );
      }
      return null;
    })
}

<style>
  img {
    border-radius: 5px;
    width: 100%;
    height: auto;
  }

  .igPost {
    color: purple;
    font-size: 1.25em;
    font-weight: bold;
    text-decoration: underline;
    cursor: pointer;
  }

  p {
    white-space: pre-line;
  }

  video {
    width: 100%;
    height: auto;
  }
</style>
